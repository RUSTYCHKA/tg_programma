{% extends "base.html" %}
{% block title %}–°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–æ–≤/–∫–∞–Ω–∞–ª–æ–≤{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/profile_edit.css') }}">
{% endblock %}

{% block content %}
<div class="proxy-page">
    <h1 class="page-title">–°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–æ–≤/–∫–∞–Ω–∞–ª–æ–≤</h1>

    <!-- –ö–Ω–æ–ø–∫–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤/—Ñ–∞–π–ª–æ–≤ -->
    <div class="card">
        <div class="card-body">
            <div class="file-buttons-container">
                <button class="btn btn-light" id="btn-chat-names">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1">
                        <path d="M4 20h16"></path>
                        <path d="m6 16 6-12 6 12"></path>
                        <path d="M8 12h8"></path>
                    </svg>
                    –ù–∞–∑–≤–∞–Ω–∏—è
                </button>
                <button class="btn btn-light" id="btn-chat-usernames">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1">
                        <circle cx="12" cy="12" r="4"></circle>
                        <path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8"></path>
                    </svg>
                    –Æ–∑–µ—Ä–Ω–µ–π–º—ã
                </button>
                <button class="btn btn-light" id="btn-chat-bio">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1">
                        <path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z"></path>
                        <path d="M14 8H8"></path>
                        <path d="M16 12H8"></path>
                        <path d="M13 16H8"></path>
                    </svg>
                    –ë–∏–æ
                </button>
                <button class="btn btn-light" id="btn-chat-avatars">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1">
                        <path d="M18 20a6 6 0 0 0-12 0"></path>
                        <circle cx="12" cy="10" r="4"></circle>
                        <circle cx="12" cy="12" r="10"></circle>
                    </svg>
                    –ê–≤–∞—Ç–∞—Ä–∫–∏
                    <span class="help-icon" data-tooltip="–ü–æ–ª–æ–∂–∏—Ç–µ —Å—é–¥–∞ —Ñ–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –û–Ω–∏ –±—É–¥—É—Ç –≤—ã–±–∏—Ä–∞—Ç—å—Å—è —Å–ª—É—á–∞–π–Ω–æ. –ê —á—Ç–æ–±—ã –Ω–µ –≤—ã—Å—Ç–∞–≤–ª—è—Ç—å –∞–≤–∞—Ç–∞—Ä–∫–∏ –≤–∞—à–∏–º —á–∞—Ç–∞–º/–∫–∞–Ω–∞–ª–∞–º, –æ—Å—Ç–∞–≤—å—Ç–µ –ø–∞–ø–∫—É –ø—É—Å—Ç–æ–π.">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                    </span>
                </button>
                <button class="btn btn-light" id="btn-chat-admins">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1">
                        <path d="M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z"></path>
                        <path d="M5 21h14"></path>
                    </svg>
                    –ê–¥–º–∏–Ω—ã
                    <span class="help-icon" data-tooltip="–°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–∞–∂–¥—ã–π —á–∞—Ç/–∫–∞–Ω–∞–ª.">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                    </span>
                </button>
                <button class="btn btn-light" id="btn-chat-posts">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        <path d="M13 8H7"></path>
                        <path d="M17 12H7"></path>
                    </svg>
                    –ü–æ—Å—Ç—ã
                    <span class="help-icon" data-tooltip="–≠—Ç–æ –ø–æ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –Ω–∞ –≤—Å–µ –≤–∞—à–∏ —á–∞—Ç—ã/–∫–∞–Ω–∞–ª—ã. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –ø–æ—Å—Ç–æ–≤ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ —Å–æ—Ñ—Ç–∞.">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                    </span>
                </button>
                <button class="btn btn-light" id="btn-chat-results">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1">
                        <rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect>
                        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                        <path d="m9 14 2 2 4-4"></path>
                    </svg>
                    –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
                </button>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div class="card">
        <div class="card-body">
            <div class="options-container">
                <div>
                    <label for="chatType" class="form-label">–ß—Ç–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å</label>
                    <div class="input-group">
                        <select class="form-select rounded-end" id="chatType" style="width: 200px">
                            <option value="–ß–∞—Ç—ã">–ß–∞—Ç—ã</option>
                            <option value="–ö–∞–Ω–∞–ª—ã" selected>–ö–∞–Ω–∞–ª—ã</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label for="chatCount" class="form-label">–°–∫–æ–ª—å–∫–æ —à—Ç—É–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞</label>
                    <div class="input-group" style="max-width: 200px">
                        <input class="form-control rounded-end" id="chatCount" type="number" min="1" value="3">
                        <div class="invalid-feedback" id="invalid-feedback-for-chatCount"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–æ–≤ -->
    <div class="card">
        <div class="card-body">
            <h3 class="subsection-title subsection-title-collapse collapsed" id="adminRightsHeader">
                –ö–∞–∫–∏–µ –ø—Ä–∞–≤–∞ –≤—ã–¥–∞–≤–∞—Ç—å –∞–¥–º–∏–Ω–∞–º
                <svg class="svg-icon collapse-chevron" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4px" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"></path></svg>
            </h3>
            <div class="collapse" id="adminRightsOptions">
                <div class="options-container">
                    <div>
                        <label for="changeProfile" class="form-label">–ò–∑–º–µ–Ω—è—Ç—å –ø—Ä–æ—Ñ–∏–ª—å —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="changeProfile" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-changeProfile"></div>
                        </div>
                    </div>
                    <div>
                        <label for="deleteMessages" class="form-label">–£–¥–∞–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="deleteMessages" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-deleteMessages"></div>
                        </div>
                    </div>
                    <div>
                        <label for="banMembers" class="form-label">–ë–∞–Ω–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="banMembers" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-banMembers"></div>
                        </div>
                    </div>
                    <div>
                        <label for="addUsers" class="form-label">–î–æ–±–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="addUsers" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-addUsers"></div>
                        </div>
                    </div>
                    <div>
                        <label for="pinMessages" class="form-label">–ó–∞–∫—Ä–µ–ø–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="pinMessages" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-pinMessages"></div>
                        </div>
                    </div>
                    <div>
                        <label for="addAdmins" class="form-label">–î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã—Ö –∞–¥–º–∏–Ω–æ–≤</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="addAdmins" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-addAdmins"></div>
                        </div>
                    </div>
                    <div>
                        <label for="manageVideoChat" class="form-label">–£–ø—Ä–∞–≤–ª—è—Ç—å –≤–∏–¥–µ–æ —á–∞—Ç–æ–º/—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–µ–π</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="manageVideoChat" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-manageVideoChat"></div>
                        </div>
                    </div>
                    <div>
                        <label for="anonymousAdmin" class="form-label">–ë—ã—Ç—å –∞–Ω–æ–Ω–∏–º–Ω—ã–º –∞–¥–º–∏–Ω–æ–º</label>
                        <span class="help-icon" data-tooltip="–í–∫–ª—é—á–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–¥–µ–ª–∞–µ—Ç –∞–¥–º–∏–Ω–∞ –∞–Ω–æ–Ω–∏–º–Ω—ã–º. –û–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –≤—ã–∫–ª—é—á–∏—Ç—å —Å–≤–æ—é –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å —Å–∞–º.">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                        </span>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="anonymousAdmin">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-anonymousAdmin"></div>
                        </div>
                    </div>
                    <div>
                        <label for="manageTopics" class="form-label">–£–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ø–∏–∫–∞–º–∏ (–¥–ª—è —á–∞—Ç–æ–≤)</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="manageTopics" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-manageTopics"></div>
                        </div>
                    </div>
                    <div>
                        <label for="publishPosts" class="form-label">–ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–æ—Å—Ç—ã (–¥–ª—è –∫–∞–Ω–∞–ª–æ–≤)</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="publishPosts" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-publishPosts"></div>
                        </div>
                    </div>
                    <div>
                        <label for="editPosts" class="form-label">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç—ã (–¥–ª—è –∫–∞–Ω–∞–ª–æ–≤)</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="editPosts" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-editPosts"></div>
                        </div>
                    </div>
                    <div>
                        <label for="manageStories" class="form-label">–£–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç–æ—Ä–∏—Å–∞–º–∏ (–¥–ª—è –∫–∞–Ω–∞–ª–æ–≤)</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="manageStories" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-manageStories"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü—Ä–∞–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–¥–ª—è —á–∞—Ç–æ–≤) -->
    <div class="card">
        <div class="card-body">
            <h3 class="subsection-title subsection-title-collapse collapsed" id="memberRightsHeader">
                –ü—Ä–∞–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–¥–ª—è —á–∞—Ç–æ–≤)
                <svg class="svg-icon collapse-chevron" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4px" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"></path></svg>
            </h3>
            <div class="collapse" id="memberRightsOptions">
                <div class="options-container">
                    <div>
                        <label for="sendMessages" class="form-label">–û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="sendMessages" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-sendMessages"></div>
                        </div>
                    </div>
                    <div>
                        <label for="sendMedia" class="form-label">–û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –º–µ–¥–∏–∞</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="sendMedia" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-sendMedia"></div>
                        </div>
                    </div>
                    <div>
                        <label for="sendPolls" class="form-label">–û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ–ø—Ä–æ—Å—ã</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="sendPolls" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-sendPolls"></div>
                        </div>
                    </div>
                    <div>
                        <label for="inviteUsers" class="form-label">–ü—Ä–∏–≥–ª–∞—à–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="inviteUsers" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-inviteUsers"></div>
                        </div>
                    </div>
                    <div>
                        <label for="changeChatProfile" class="form-label">–ò–∑–º–µ–Ω—è—Ç—å –ø—Ä–æ—Ñ–∏–ª—å —á–∞—Ç–∞</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="changeChatProfile">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-changeChatProfile"></div>
                        </div>
                    </div>
                    <div>
                        <label for="pinMessagesMembers" class="form-label">–ó–∞–∫—Ä–µ–ø–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="pinMessagesMembers">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-pinMessagesMembers"></div>
                        </div>
                    </div>
                    <div>
                        <label for="manageTopicsMembers" class="form-label">–£–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ø–∏–∫–∞–º–∏</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="manageTopicsMembers">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-manageTopicsMembers"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å -->
    <div class="card">
        <div class="card-body">
            <h3 class="subsection-title subsection-title-collapse collapsed" id="errorHandlingHeader">
                –ö–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å
                <svg class="svg-icon collapse-chevron" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4px" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"></path></svg>
            </h3>
            <div class="collapse" id="errorHandlingOptions">
                <div class="options-container">
                    <div>
                        <label for="skipAdminErrors" class="form-label">–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–¥–º–∏–Ω–æ–≤</label>
                        <span class="help-icon" data-tooltip="–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —á–∞—Ç—ã/–∫–∞–Ω–∞–ª—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ —Å–º–æ–≥ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–≥–æ-—Ç–æ –∏–∑ –∞–¥–º–∏–Ω–æ–≤. –û—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –∑–∞–∫–ª—é—á–∞—Ç—å—Å—è –≤ —Ç–æ–º, —á—Ç–æ –∞–¥–º–∏–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏–ª–∏ —É –Ω–µ–≥–æ —Å—Ç–æ–∏—Ç –∑–∞–ø—Ä–µ—Ç –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—ã, –∏–ª–∏ –Ω–∞—à –∞–∫–∫–∞—É–Ω—Ç –ø–æ–ª—É—á–∏–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –∏ —Ç.–¥.">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                        </span>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="skipAdminErrors">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-skipAdminErrors"></div>
                        </div>
                    </div>
                    <div>
                        <label for="skipPostErrors" class="form-label">–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–æ—Å—Ç–æ–≤</label>
                        <span class="help-icon" data-tooltip="–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —á–∞—Ç—ã/–∫–∞–Ω–∞–ª—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ —Å–º–æ–≥ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∫–æ–π-—Ç–æ –∏–∑ –ø–æ—Å—Ç–æ–≤. –û—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –∑–∞–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞—à –∞–∫–∫–∞—É–Ω—Ç –ø–æ–ª—É—á–∏–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É.">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                        </span>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="skipPostErrors">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-skipPostErrors"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –†–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div class="card">
        <div class="card-body">
            <h3 class="subsection-title subsection-title-collapse collapsed" id="miscSettingsHeader">
                –†–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                <svg class="svg-icon collapse-chevron" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4px" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"></path></svg>
            </h3>
            <div class="collapse" id="miscSettingsOptions">
                <div class="options-container">
                    <div>
                        <label for="pinChannelInProfile" class="form-label">–ó–∞–∫—Ä–µ–ø–ª—è—Ç—å –∫–∞–Ω–∞–ª –≤ –ø—Ä–æ—Ñ–∏–ª–µ —Å–æ–∑–¥–∞—Ç–µ–ª—è</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="pinChannelInProfile">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-pinChannelInProfile"></div>
                        </div>
                    </div>
                    <div>
                        <label for="disableReactions" class="form-label">–û—Ç–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–∫—Ü–∏–∏</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="disableReactions">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-disableReactions"></div>
                        </div>
                    </div>
                    <div>
                        <label for="postDelay" class="form-label">–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏ –ø–æ—Å—Ç–æ–≤</label>
                        <span class="help-icon" data-tooltip="–ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω. –ù–∞–ø—Ä–∏–º–µ—Ä &quot;5-20&quot;">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                        </span>
                        <div class="input-group" style="max-width: 200px">
                            <input class="form-control has-trailing-label" id="postDelay" value="0">
                            <span class="input-trailing-label">—Å–µ–∫</span>
                            <div class="invalid-feedback" id="invalid-feedback-for-postDelay"></div>
                        </div>
                    </div>
                    <div>
                        <label for="pinFirstPost" class="form-label">–ó–∞–∫—Ä–µ–ø–ª—è—Ç—å –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="pinFirstPost">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-pinFirstPost"></div>
                        </div>
                    </div>
                    <div>
                        <label for="chatCreationDelay" class="form-label">–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞</label>
                        <span class="help-icon" data-tooltip="–ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω. –ù–∞–ø—Ä–∏–º–µ—Ä &quot;5-20&quot;">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                        </span>
                        <div class="input-group" style="max-width: 200px">
                            <input class="form-control has-trailing-label" id="chatCreationDelay" value="0">
                            <span class="input-trailing-label">—Å–µ–∫</span>
                            <div class="invalid-feedback" id="invalid-feedback-for-chatCreationDelay"></div>
                        </div>
                    </div>
                    <div>
                        <label for="slowMode" class="form-label">–ú–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º (–¥–ª—è —á–∞—Ç–æ–≤)</label>
                        <select class="form-select rounded-end" id="slowMode" style="width: 200px">
                            <option value="–û—Ç–∫–ª—é—á–µ–Ω–æ" selected>–û—Ç–∫–ª—é—á–µ–Ω–æ</option>
                            <option value="10 —Å–µ–∫—É–Ω–¥">10 —Å–µ–∫—É–Ω–¥</option>
                            <option value="30 —Å–µ–∫—É–Ω–¥">30 —Å–µ–∫—É–Ω–¥</option>
                            <option value="1 –º–∏–Ω—É—Ç–∞">1 –º–∏–Ω—É—Ç–∞</option>
                            <option value="5 –º–∏–Ω—É—Ç">5 –º–∏–Ω—É—Ç</option>
                            <option value="15 –º–∏–Ω—É—Ç">15 –º–∏–Ω—É—Ç</option>
                            <option value="1 —á–∞—Å">1 —á–∞—Å</option>
                        </select>
                    </div>
                    <div>
                        <label for="enableTopics" class="form-label">–í–∫–ª—é—á–∏—Ç—å —Ç–æ–ø–∏–∫–∏ (–¥–ª—è —á–∞—Ç–æ–≤)</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="enableTopics">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-enableTopics"></div>
                        </div>
                    </div>
                    <div>
                        <label for="showHistory" class="form-label">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–¥–ª—è —á–∞—Ç–æ–≤)</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="showHistory" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-showHistory"></div>
                        </div>
                    </div>
                    <div>
                        <label for="messageTimer" class="form-label">–¢–∞–π–º–µ—Ä —Å–∞–º–æ—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–ª—è —á–∞—Ç–æ–≤)</label>
                        <div class="input-group" style="max-width: 200px">
                            <input class="form-control has-trailing-label" id="messageTimer" placeholder="–û—Ç–∫–ª—é—á–µ–Ω–æ" value="">
                            <span class="input-trailing-label">—Å–µ–∫</span>
                            <div class="invalid-feedback" id="invalid-feedback-for-messageTimer"></div>
                        </div>
                    </div>
                    <div>
                        <label for="leaveAfterCreation" class="form-label">–ü–æ–∫–∏–¥–∞—Ç—å –≥—Ä—É–ø–ø—É/–∫–∞–Ω–∞–ª –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="leaveAfterCreation">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-leaveAfterCreation"></div>
                        </div>
                    </div>
                    <div>
                        <label for="deleteSystemMessages" class="form-label">–£–¥–∞–ª–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è</label>
                        <span class="help-icon" data-tooltip="–î–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∑–≤–æ–ª–∏—Ç —É–¥–∞–ª–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ —Å–º–µ–Ω–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–¥–º–∏–Ω–æ–≤.">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                        </span>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="deleteSystemMessages" checked>
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-deleteSystemMessages"></div>
                        </div>
                    </div>
                    <div>
                        <label for="makeCreatorAnonymous" class="form-label">–î–µ–ª–∞—Ç—å —Å–æ–∑–¥–∞—Ç–µ–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã–º</label>
                        <span class="help-icon" data-tooltip="–î–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–∞ –¥–ª—è —á–∞—Ç–æ–≤. –ï—Å–ª–∏ –µ—ë –≤–∫–ª—é—á–∏—Ç—å, —Ç–æ –ø–æ—Å—Ç—ã –±—É–¥—É—Ç —Ä–∞–∑–º–µ—â–∞—Ç—å—Å—è –æ—Ç –∏–º–µ–Ω–∏ —Å–∞–º–æ–≥–æ —á–∞—Ç–∞, –∞ –Ω–µ –æ—Ç –∏–º–µ–Ω–∏ –µ–≥–æ —Å–æ–∑–¥–∞—Ç–µ–ª—è.">
<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                        </span>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="makeCreatorAnonymous">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-makeCreatorAnonymous"></div>
                        </div>
                    </div>
                    <div>
                        <label for="disableCopyContent" class="form-label">–ó–∞–ø—Ä–µ—Ç–∏—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</label>
                        <div class="input-group">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="disableCopyContent">
                            </div>
                            <div class="invalid-feedback" id="invalid-feedback-for-disableCopyContent"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ -->
<div class="start-task-btn-group">
    <button type="button" class="start-task-btn" id="start-chat-creation-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="6 3 20 12 6 21 6 3"></polygon></svg>
        –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ
    </button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∑–∞–ø—É—Å–∫–∞ -->
<div class="modal" id="chatCreationTaskModal">
    <div class="modal-content">
        <div class="modal-body">
            <div class="options-container">
                <div class="mb-4">
                    <button class="btn btn-primary w-100" id="select-accounts-btn">
                        <span>–ê–∫–∫–∞—É–Ω—Ç—ã</span>
                        <span class="mx-1 opacity-50">|</span>
                        <span id="accounts-picked-for-task-count">0</span>
                    </button>
                </div>
                <div>
                    <label for="threadCount" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤</label>
                    <span class="help-icon ms-1" data-tooltip="–°–∫–æ–ª—å–∫–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.">
                        <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                    </span>
                    <div class="input-group">
                        <input class="form-control" id="threadCount" type="number" min="1" max="50" value="1">
                        <div class="invalid-feedback" id="invalid-feedback-for-threadCount"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary btn-lg" id="do-start-chat-creation-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-2"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"></path><path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"></path><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"></path><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"></path></svg>
                <span>–ó–∞–ø—É—Å—Ç–∏—Ç—å</span>
            </button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–≥–∏–∫—É –∫–∞–∫ –≤ profile_edit) -->
<div class="modal" id="accountsModal" style="display: none;">
    <div class="modal-content" style="width: 90%; max-width: 1200px; height: 80vh;">
        <div class="modal-header">
            <h5 class="modal-title">–í—ã–±–æ—Ä –∞–∫–∫–∞—É–Ω—Ç–æ–≤</h5>
            <button type="button" class="modal-close" id="accountsModalClose">&times;</button>
        </div>
        <div class="modal-body" style="height: calc(100% - 120px); overflow: hidden;">
            <div class="proxy-container" style="height: 100%;">
                <div class="header-section">
                    <div class="table-controls">
                        <div class="account-folder-selector">
                            <button class="account-folder-btn active" id="all-folder-accounts">
                                <div class="account-count" data-count="0">0</div>
                                <div class="account-label">–í—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã</div>
                                <div class="active-indicator"></div>
                            </button>
                            <button class="account-folder-btn" id="working-folder-accounts">
                                <div class="account-count" data-count="0">0</div>
                                <div class="account-label">–î–ª—è —Ä–∞–±–æ—Ç—ã</div>
                                <div class="active-indicator"></div>
                            </button>
                            <button class="account-folder-btn" id="archive-folder-accounts">
                                <div class="account-count" data-count="0">0</div>
                                <div class="account-label">–ê—Ä—Ö–∏–≤</div>
                                <div class="active-indicator"></div>
                            </button>
                            <button class="account-folder-btn" id="no-spam-folder-accounts">
                                <div class="account-count" data-count="0">0</div>
                                <div class="account-label">–ë–µ–∑ —Å–ø–∞–º–±–ª–æ–∫–∞</div>
                                <div class="active-indicator"></div>
                            </button>
                            <button class="account-folder-btn" id="with-spam-folder-accounts">
                                <div class="account-count" data-count="0">0</div>
                                <div class="account-label">–°–ø–∞–º–±–ª–æ–∫</div>
                                <div class="active-indicator"></div>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card mb-3">
                    <div class="card-body p-3 d-flex align-items-center">
                        <div class="d-flex gap-2">
                            <button class="btn btn-light" id="select-all-accounts-modal">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 7 17l-5-5"></path><path d="m22 10-7.5 7.5L13 16"></path></svg>
                            </button>
                            <button id="deselect-all-btn-modal" type="button" class="btn btn-light">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
                            </button>
                        </div>
                        <span class="text-muted ms-auto" id="accounts-count-label-modal">–ü–æ–∫–∞–∑–∞–Ω–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤: 0 / 0</span>
                    </div>
                </div>
                                <div style="height: calc(100% - 200px); overflow-y: auto;">
                    <table id="accounts-table-modal" class="proxy-table">
                        <thead>
                            <tr>
                                <th class="selector-header"><input type="checkbox" id="select-all-checkbox-modal" class="select-all-checkbox"></th>
                                <th>#</th>
                                <th>–ê–≤–∞—Ç–∞—Ä</th>
                                <th><div class="sortable-header" data-sort="phone">–¢–µ–ª–µ—Ñ–æ–Ω<div class="sort-icons"><span class="sort-asc">‚ñ≤</span><span class="sort-desc">‚ñº</span></div></div></th>
                                <th><div class="sortable-header" data-sort="geo">–ì–µ–æ<div class="sort-icons"><span class="sort-asc">‚ñ≤</span><span class="sort-desc">‚ñº</span></div></div></th>
                                <th><div class="sortable-header" data-sort="status">–°—Ç–∞—Ç—É—Å<div class="sort-icons"><span class="sort-asc">‚ñ≤</span><span class="sort-desc">‚ñº</span></div></div></th>
                                <th>–û—Ç–ª–µ–∂–∫–∞</th>
                                <th><div class="sortable-header" data-sort="role">–†–æ–ª—å<div class="sort-icons"><span class="sort-asc">‚ñ≤</span><span class="sort-desc">‚ñº</span></div></div></th>
                                <th>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω</th>
                                <th><div class="sortable-header" data-sort="name">–ò–º—è<div class="sort-icons"><span class="sort-asc">‚ñ≤</span><span class="sort-desc">‚ñº</span></div></div></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="accountsModalCancel">–û—Ç–º–µ–Ω–∞</button>
            <button type="button" class="btn btn-primary" id="confirmAccountsSelection">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å (<span id="selected-count-modal">0</span>)</button>
        </div>
    </div>
</div>

<div id="customTooltip" class="custom-tooltip"></div>

<script>
// –†–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –º–æ–¥–∞–ª–æ–∫ –∏ —Ç–∞–±–ª–∏—Ü—ã –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏–∑ profile_edit
let selectedAccounts = new Set();
let allAccounts = [];
let currentFolder = 'all';
let currentSpamFilter = null;
let currentSort = { field: null, direction: 'asc' };
let searchFilter = '';
let roleFilter = '';
let geoFilter = '';
let statusFilter = '';

function showModal(modalId) {
    document.getElementById(modalId).classList.add('show');
    document.getElementById(modalId).style.display = 'block';
}
function hideModal(modalId) {
    document.getElementById(modalId).classList.remove('show');
    setTimeout(() => { document.getElementById(modalId).style.display = 'none'; }, 1);
}

function updateSelectedAccountsCount() {
    const el = document.getElementById('accounts-picked-for-task-count');
    if (el) el.textContent = selectedAccounts.size;
    const el2 = document.getElementById('selected-count-modal');
    if (el2) el2.textContent = selectedAccounts.size;
}

function selectAllAccountsInModal() {
    document.querySelectorAll('.account-checkbox').forEach(checkbox => {
        const accountId = checkbox.getAttribute('data-account-id');
        selectedAccounts.add(accountId);
        checkbox.checked = true;
    });
    updateSelectedAccountsCount();
}
function deselectAllAccountsInModal() {
    selectedAccounts.clear();
    document.querySelectorAll('.account-checkbox').forEach(checkbox => { checkbox.checked = false; });
    updateSelectedAccountsCount();
}

async function loadAccounts(folder = 'all') {
    try {
        const response = await fetch('/get_accounts', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ folder }) });
        if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤');
        allAccounts = await response.json();
        renderAccountsTable();
        updateAccountsCount();
    } catch (e) { console.error(e); }
}

function getStatusClass(status) {
    switch (status) {
        case 'alive': return 'alive';
        case 'dead': return 'dead';
        case 'spam_block': return 'spam-block';
        default: return 'unknown';
    }
}
function getStatusText(status) {
    switch (status) {
        case 'alive': return '–ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π';
        case 'dead': return '–ú–µ—Ä—Ç–≤';
        case 'spam_block': return '–°–ø–∞–º –±–ª–æ–∫';
        default: return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
    }
}
function getCountryData(){ return { RU:{name:'–†–æ—Å—Å–∏—è'}, UA:{name:'–£–∫—Ä–∞–∏–Ω–∞'}, KZ:{name:'–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω'}, US:{name:'–°–®–ê'} }; }
function getCountryInfo(code){ const m=getCountryData(); return m[code]||{name:code||'–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}; }
function getFlagEmoji(code){ if(!code) return 'üè≥Ô∏è'; const cps=code.toUpperCase().split('').map(c=>127397+c.charCodeAt(0)); try{ return String.fromCodePoint(...cps);}catch(e){return 'üè≥Ô∏è';}}

function renderAccountsTable() {
    const tbody = document.querySelector('#accounts-table-modal tbody');
    if (!tbody) return;
    tbody.innerHTML = (allAccounts || []).map((account, index) => {
        const fullName = `${account.first_name || ''} ${account.last_name || ''}`.trim();
        const countryInfo = getCountryInfo(account.geo);
        const flagEmoji = getFlagEmoji(account.geo);
        return `
            <tr data-account-id="${account.id}" class="account-row">
                <td><input type="checkbox" class="account-checkbox" data-account-id="${account.id}" ${selectedAccounts.has(account.id) ? 'checked' : ''}></td>
                <td>${index + 1}</td>
                <td class="avatar-cell"><div class="avatar-placeholder">${(account.first_name||account.last_name||'?').toString().charAt(0).toUpperCase()}</div></td>
                <td>${account.phone || ''}</td>
                <td><div class="geo-cell" title="${countryInfo.name}"><span class="country-flag">${flagEmoji}</span><span class="country-code">${account.geo||''}</span></div></td>
                <td><span class="status-badge ${getStatusClass(account.status)}">${getStatusText(account.status)}</span></td>
                <td class="rest-period" data="${account.register_time}">${account.rest_until || '-'}</td>
                <td>${account.role || ''}</td>
                <td>${account.last_used || '–ù–µ—Ç'}</td>
                <td>${fullName || ''}</td>
            </tr>
        `;
    }).join('');

    document.querySelectorAll('.account-checkbox').forEach(cb => {
        cb.addEventListener('change', function(){
            const id = this.dataset.accountId;
            if (this.checked) selectedAccounts.add(id); else selectedAccounts.delete(id);
            updateSelectedAccountsCount();
        });
    });
}

function updateAccountsCount(){
    const total = allAccounts.length;
    const displayed = document.querySelectorAll('#accounts-table-modal tbody tr').length;
    const el = document.getElementById('accounts-count-label-modal');
    if (el) el.textContent = `–ü–æ–∫–∞–∑–∞–Ω–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤: ${displayed} / ${total}`;
}

// –¢–æ–≥–≥–ª—ã —Å–µ–∫—Ü–∏–π
function toggleSection(headerId, contentId) {
    const content = document.getElementById(contentId);
    const header = document.getElementById(headerId);
    const chevron = header?.querySelector('.collapse-chevron');
    if (!content || !header || !chevron) return;
    content.classList.toggle('show');
    header.classList.toggle('collapsed');
    chevron.classList.toggle('rotated');
}

document.addEventListener('DOMContentLoaded', function(){
    // –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞
    document.getElementById('start-chat-creation-btn').addEventListener('click', function(){ showModal('chatCreationTaskModal'); });
    document.getElementById('chatCreationTaskModal').addEventListener('click', function(e){ if (e.target === this) hideModal('chatCreationTaskModal'); });

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –≤—ã–±–æ—Ä–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
    document.getElementById('select-accounts-btn').addEventListener('click', function(){
        hideModal('chatCreationTaskModal');
        showModal('accountsModal');
        loadAccounts();
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
    document.getElementById('accountsModalClose').addEventListener('click', () => hideModal('accountsModal'));
    document.getElementById('accountsModalCancel').addEventListener('click', () => hideModal('accountsModal'));
    document.getElementById('accountsModal').addEventListener('click', function(e){ if (e.target === this) hideModal('accountsModal'); });
    document.getElementById('confirmAccountsSelection').addEventListener('click', function(){ hideModal('accountsModal'); showModal('chatCreationTaskModal'); });

    // –°–µ–ª–µ–∫—Ç—ã –ø–∞–ø–æ–∫ –∏ —Å–ø–∞–º —Ñ–∏–ª—å—Ç—Ä–æ–≤
    document.getElementById('all-folder-accounts')?.addEventListener('click', () => { currentFolder='all'; loadAccounts('all'); });
    document.getElementById('working-folder-accounts')?.addEventListener('click', () => { currentFolder='working'; loadAccounts('working'); });
    document.getElementById('archive-folder-accounts')?.addEventListener('click', () => { currentFolder='archive'; loadAccounts('archive'); });
    document.getElementById('no-spam-folder-accounts')?.addEventListener('click', () => { currentSpamFilter='no-spam'; loadAccounts(currentFolder); });
    document.getElementById('with-spam-folder-accounts')?.addEventListener('click', () => { currentSpamFilter='with-spam'; loadAccounts(currentFolder); });

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ/—Å–Ω—è—Ç–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è
    document.getElementById('select-all-accounts-modal').addEventListener('click', selectAllAccountsInModal);
    document.getElementById('deselect-all-btn-modal').addEventListener('click', deselectAllAccountsInModal);
    const selectAllCheckbox = document.getElementById('select-all-checkbox-modal');
    if (selectAllCheckbox) {
        selectAllCheckbox.addEventListener('change', function(){ this.checked ? selectAllAccountsInModal() : deselectAllAccountsInModal(); });
    }

    // –¢–æ–≥–≥–ª—ã —Å–µ–∫—Ü–∏–π
    document.getElementById('adminRightsHeader').addEventListener('click', () => toggleSection('adminRightsHeader','adminRightsOptions'));
    document.getElementById('memberRightsHeader').addEventListener('click', () => toggleSection('memberRightsHeader','memberRightsOptions'));
    document.getElementById('errorHandlingHeader').addEventListener('click', () => toggleSection('errorHandlingHeader','errorHandlingOptions'));
    document.getElementById('miscSettingsHeader').addEventListener('click', () => toggleSection('miscSettingsHeader','miscSettingsOptions'));

    // –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á–∏
    document.getElementById('do-start-chat-creation-btn').addEventListener('click', function(){
        const threadCount = parseInt(document.getElementById('threadCount').value, 10);
        const selectedAccountIds = Array.from(selectedAccounts);
        if (!selectedAccountIds.length) { alert('–í—ã–±–µ—Ä–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–æ–≤/–∫–∞–Ω–∞–ª–æ–≤'); return; }
        if (!threadCount || threadCount < 1 || threadCount > 50) { alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ (1-50)'); return; }

        const settings = {
            chatType: document.getElementById('chatType').value,
            chatCount: parseInt(document.getElementById('chatCount').value, 10),
            adminRights: {
                changeProfile: document.getElementById('changeProfile').checked,
                deleteMessages: document.getElementById('deleteMessages').checked,
                banMembers: document.getElementById('banMembers').checked,
                addUsers: document.getElementById('addUsers').checked,
                pinMessages: document.getElementById('pinMessages').checked,
                addAdmins: document.getElementById('addAdmins').checked,
                manageVideoChat: document.getElementById('manageVideoChat').checked,
                anonymousAdmin: document.getElementById('anonymousAdmin').checked,
                manageTopics: document.getElementById('manageTopics').checked,
                publishPosts: document.getElementById('publishPosts').checked,
                editPosts: document.getElementById('editPosts').checked,
                manageStories: document.getElementById('manageStories').checked
            },
            memberRights: {
                sendMessages: document.getElementById('sendMessages').checked,
                sendMedia: document.getElementById('sendMedia').checked,
                sendPolls: document.getElementById('sendPolls').checked,
                inviteUsers: document.getElementById('inviteUsers').checked,
                changeChatProfile: document.getElementById('changeChatProfile').checked,
                pinMessagesMembers: document.getElementById('pinMessagesMembers').checked,
                manageTopicsMembers: document.getElementById('manageTopicsMembers').checked
            },
            errorHandling: {
                skipAdminErrors: document.getElementById('skipAdminErrors').checked,
                skipPostErrors: document.getElementById('skipPostErrors').checked
            },
            miscSettings: {
                pinChannelInProfile: document.getElementById('pinChannelInProfile').checked,
                disableReactions: document.getElementById('disableReactions').checked,
                postDelay: document.getElementById('postDelay').value,
                pinFirstPost: document.getElementById('pinFirstPost').checked,
                chatCreationDelay: document.getElementById('chatCreationDelay').value,
                slowMode: document.getElementById('slowMode').value,
                enableTopics: document.getElementById('enableTopics').checked,
                showHistory: document.getElementById('showHistory').checked,
                messageTimer: document.getElementById('messageTimer').value,
                leaveAfterCreation: document.getElementById('leaveAfterCreation').checked,
                deleteSystemMessages: document.getElementById('deleteSystemMessages').checked,
                makeCreatorAnonymous: document.getElementById('makeCreatorAnonymous').checked,
                disableCopyContent: document.getElementById('disableCopyContent').checked
            }
        };

        fetch('/start_chat_creation_task', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ account_ids: selectedAccountIds, thread_count: threadCount, settings })
        })
        .then(r => r.json())
        .then(data => {
            if (data.success) {
                alert('–°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–æ–≤/–∫–∞–Ω–∞–ª–æ–≤ –∑–∞–ø—É—â–µ–Ω–æ!');
                hideModal('chatCreationTaskModal');
                selectedAccounts.clear();
                updateSelectedAccountsCount();
            } else {
                alert('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞: ' + (data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
            }
        })
        .catch(err => { console.error(err); alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ: ' + err.message); });
    });

    // –õ–µ–≥–∫–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –∑–∞–ø—É—Å–∫–∞
    setTimeout(() => { document.getElementById('start-chat-creation-btn').classList.add('pulse'); }, 1000);
});

// –¢—É–ª—Ç–∏–ø—ã
document.addEventListener('mouseover', function(e){
    if (e.target.closest('[data-tooltip]')) {
        const t = e.target.closest('[data-tooltip]').getAttribute('data-tooltip');
        const el = document.getElementById('customTooltip');
        el.textContent = t; el.style.left = (e.pageX+2)+'px'; el.style.top = (e.pageY-4)+'px'; el.classList.add('show');
    }
});
document.addEventListener('mouseout', function(e){ if (e.target.closest('[data-tooltip]')) document.getElementById('customTooltip').classList.remove('show'); });

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–æ–≤
document.getElementById('btn-chat-results')?.addEventListener('click', function() {
    fetch('/api/open-folder?path=–§–∞–π–ª—ã/–°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–æ–≤/–†–µ–∑—É–ª—å—Ç–∞—Ç—ã')
        .then(response => {
            if (!response.ok) {
                return response.text().then(errorMessage => {
                    if (typeof showNotification === 'function') {
                        showNotification('–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–∞–ø–∫–∏: ' + errorMessage, 'error');
                    } else {
                        alert('–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–∞–ø–∫–∏: ' + errorMessage);
                    }
                });
            }
            if (typeof showNotification === 'function') {
                showNotification('–ü–∞–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞', 'success');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–∞–ø–∫–∏:', error);
            if (typeof showNotification === 'function') {
                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–∞–ø–∫–∏: ' + error.message, 'error');
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–∞–ø–∫–∏: ' + error.message);
            }
        });
});
</script>
{% endblock %}